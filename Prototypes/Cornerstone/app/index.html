<!DOCTYPE html>

<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <title>cornerstoneApp</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1" />
    <link rel="stylesheet" href="bower/_bower.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="">
  </head>

  <body ng-app="cornerstoneApp">
    <h1>Welcome to Boom Angular.js Generator!</h1>
    <input id="series-slider" type="range" min="0" max="49" step="1" value="0"
      oninput="updateTheImage(this.value)" onchange="updateTheImage(this.value)"/>
    <div id="dicomImage" style="width:512px;height:512px;"></div>
    <div ng-view></div>
    
    <!--<script type="text/javascript" src="http://code.stephenmorley.org/javascript/finding-the-memory-usage-of-objects/sizeof.js"></script>-->
    <script type="text/javascript" src="bower/_bower.js"></script>
    <script type="text/javascript" src="js/all.js"></script>

    <script type="text/javascript">
        
        var element = document.getElementById('dicomImage');
        var currentImageIndex = -1;

        function updateTheImage(imageIndex) {
            if (currentImageIndex === imageIndex){
              console.log('updateTheImage not needed');
              return;
            }
            console.log('updateTheImage: ' + imageIndex);
            currentImageIndex = imageIndex;
            cornerstone.loadImage('base64://' + currentImageIndex)
              .then(function(image) {
                  console.log('before displayImage');
                  cornerstone.displayImage(element, image);
              });
        };

        $(document).ready(function() {
          cornerstone.enable(element);
          updateTheImage(0);

          $('#dicomImage').on('mousewheel DOMMouseScroll', function (e) {
              // Firefox e.originalEvent.detail > 0 scroll back, < 0 scroll forward
              // chrome/safari e.originalEvent.wheelDelta < 0 scroll back, > 0 scroll forward
              if (e.originalEvent.wheelDelta < 0 || e.originalEvent.detail > 0) {
                  currentImageIndex += 1;
              } else {
                  if (currentImageIndex > 0){
                    currentImageIndex -= 1;
                  }
              }
              updateTheImage(currentImageIndex);
              //prevent page fom scrolling
              return false;
          });
      });
    </script>

    <!-- endbuild -->
  </body>
</html>
